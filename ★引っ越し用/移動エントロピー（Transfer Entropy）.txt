【サンプルコード付き】移動エントロピー（Transfer Entropy）

学生時代に使用していた「移動エントロピー（Transfer Entropy）」という因果分析手法についての投稿です。
異常検査Gのドキュメントでは見かけなかったので参考までに共有します

■ 移動エントロピーとは？
・情報理論における相互情報量を、因果性を捉える形に拡張したもの。

■ 移動エントロピーで分析できること
・2つの時系列間の因果の方向性（一方が他方の時系列にどの程度影響を与えているか）
・2つの時系列間の伝播時間（どれくらい遅れて影響を与えているか）
※多系列に拡張した手法、位相情報のみを使用する方法もあります

■ メリット
・任意の時系列に対して適用可能（グレンジャー因果性と異なり、時系列データの正規性や因果関係の線形性を必要としない）

■ 注意点
・移動エントロピーの計算では、時系列データの確率分布を用います。
  解析対象の時系列は時間的に確率分布が一定（定常）であることが望ましいです。
  期間によって分布が変わる（非定常な）データの場合は、一定の期間ごとにウィンドウを切って移動エントロピーを計算するなどの工夫が必要です。

■ 活用事例
・交通系（道路間の渋滞伝播時間の推定）
・生体信号系（脳領域間のネットワーク可視化、てんかんなどの神経疾患の分析）※ノイズが多い生体信号でも活用事例あり
・金融系（株価分析）

■ 工場領域での使い道（案）
・生産ラインの関係性の見える化
  どのラインの変動が他ラインに影響を与えているか、そのタイミングはいつか、など。データから関係性が見えるかも
